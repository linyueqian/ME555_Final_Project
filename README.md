# Learning to Say No: Unsolvable Robotic Task Detection Using Synthetic Data

#### Final Project of ME555

## Introduction

This project focuses on training Large Multimodal Models (LMMs) to detect and appropriately respond to unsolvable robotic tasks. Using a combination of synthetic data generation and fine-tuning techniques, we develop a model that can effectively identify when a requested task is beyond a robot's capabilities and provide clear explanations for why the task cannot be performed.

## Dataset

Download our synthetic dataset from: [Box](https://duke.box.com/s/w5u131acn89zr110dn77r39h2ubemnll)

The dataset includes:
- Image-text pairs of unsolvable robotic scenarios
- Corresponding robot responses explaining task limitations

The structure of the dataset is as follows:
```
- sdxl_images: the SDXL dataset generated by SDXL
    - generated_tasks.jsonl: the text of the robot responses explaining task limitations
    - images: the images generated by SDXL

- habitat_images: the Habitat dataset generated by Habitat Simulator
    - generated_tasks.jsonl: the text of the robot responses explaining task limitations
    - images: the images generated by Habitat Simulator
``` 

## Model Checkpoints

Download our fine-tuned model weights from: [Huggingface](https://huggingface.co/linyueqian/ME555_llava_v1.5_finetuned)

Base model: LLaVA-1.5-7B

## Installation

1. Clone the repository:
```bash
bash
git clone https://github.com/linyueqian/ME555_Final_Project
cd ME555_Final_Project
```

2. Install dependencies:
```bash
pip install -r requirements.txt
```

## Inference

To run inference with our fine-tuned model:
```bash
python inference.py
```

This will load the model, process the input, and generate the output.

## Generate Synthetic Data

To generate synthetic data:
```bash
python task_generation/generate.py
python image_generation/generate.py
```

This will generate the synthetic data and save it to the specified output file.

## Citation

If you find this project useful, please cite our project:
```
@software{lin_yueqian_2024_ME555_Final_Project,
author = {Lin, Yueqian and Yang, Yixuan},
license = {Apache-2.0},
title = {{ME555_Final_Project}},
url = {https://github.com/linyueqian/ME555_Final_Project}
}
```